services:
  # The FastAPI backend service
  - type: web
    name: dermassist-backend
    runtime: image
    # Replace with your Docker Hub username/organization
    image:
      url: aaronchen2002/dermassist-api:latest
    plan: free # Use the free instance type
    healthCheckPath: /health
    envVars:
      - key: REDIS_URL
        fromService:
          type: keyvalue
          name: dermassist-redis
          property: connectionString
      - key: API_KEYS
        # This will be set in the Render dashboard, not here
        value: ""

  # The Redis instance for rate limiting
  - type: keyvalue
    name: dermassist-redis
    plan: free # Use the free instance type
    ipAllowList: [] # Allow only internal connections 